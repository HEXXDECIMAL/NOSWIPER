# NoSwiper Default Configuration
# This file is embedded at compile time and provides the default rules
# Users can override these with ~/.config/noswiper/config.yaml

# Files and patterns to protect
protected_files:
  # SSH Keys
  - pattern: "~/.ssh/id_*"
    allow:
      # SSH tools from system paths only
      - base: "ssh"
      - base: "ssh-add"
      - base: "ssh-agent"
      - base: "ssh-keygen"
      - base: "scp"
      - base: "sftp"
      - base: "rsync"

      # SSH from Homebrew Cellar (versioned paths)
      - base: "ssh"
        path_pattern: "/opt/homebrew/Cellar/openssh/*/bin/*"

      # Git from standard locations
      - base: "git"
      - base: "git-remote-https"
        path_pattern: "/usr/libexec/git-core/*"

      # Git from Developer Tools
      - base: "git"
        path_pattern: "/Library/Developer/CommandLineTools/usr/bin/*"

      # GitHub CLI
      - base: "gh"

      # GitHub CLI from Homebrew Cellar (versioned paths)
      - base: "gh"
        path_pattern: "/opt/homebrew/Cellar/gh/*/bin/*"

      # Terminal apps with ppid=1 (GUI apps launched by launchd)
      - app_id: "com.apple.Terminal"
        ppid: 1
      - app_id: "com.googlecode.iterm2"
        ppid: 1
      - app_id: "com.microsoft.VSCode"
        ppid: 1
      - team_id: "dev.warp.Warp"
        ppid: 1

  - pattern: "~/.ssh/*_key"
    allow:
      # Same as id_* keys
      - base: "ssh"
      - base: "ssh-add"
      - base: "ssh-agent"
      - base: "ssh-keygen"
      - base: "scp"
      - base: "sftp"
      - base: "rsync"
      - base: "git"

      # SSH from Homebrew Cellar (versioned paths)
      - base: "ssh"
        path_pattern: "/opt/homebrew/Cellar/openssh/*/bin/*"

      # Git from Developer Tools
      - base: "git"
        path_pattern: "/Library/Developer/CommandLineTools/usr/bin/*"

  # AWS Credentials
  - pattern: "~/.aws/credentials"
    allow:
      # AWS CLI from standard locations
      - base: "aws"

      # Terraform by team ID
      - team_id: "D38WU7D763"  # HashiCorp

      # Ansible
      - base: "ansible"
      - base: "ansible-playbook"

      # Packer
      - base: "packer"

      # Python for boto3 - must be from specific locations
      - base: "python"
      - base: "python3"
        path_pattern: "~/.venv/*/bin/*"
      - base: "python3"
        path_pattern: "~/.*env/bin/*"

  - pattern: "~/.aws/config"
    allow:
      - base: "aws"
      - team_id: "D38WU7D763"  # HashiCorp (Terraform)
      - base: "ansible"
      - base: "packer"

  # Google Cloud
  - pattern: "~/.config/gcloud/credentials.db"
    allow:
      # Google Cloud SDK tools
      - base: "gcloud"
      - base: "gsutil"
      - base: "bq"
      - base: "kubectl"

      # Python used by gcloud
      - base: "python"
      - base: "python3"
      - base: "Python"  # macOS Python wrapper
        app_id: "com.apple.python3"

  - pattern: "~/.config/gcloud/access_tokens.db"
    allow:
      - base: "gcloud"
      - base: "gsutil"
      - base: "bq"
      - base: "python"
      - base: "python3"
      - base: "Python"
        app_id: "com.apple.python3"

  # Azure
  - pattern: "~/.azure/accessTokens.json"
    allow:
      - base: "az"
      - base: "azure-cli"
      - base: "powershell"
        path_pattern: "/usr/local/microsoft/powershell/*/pwsh"
        team_id: "UBF8T346G9"  # Microsoft

  # GPG Keys
  - pattern: "~/.gnupg/private-keys*"
    allow:
      - base: "gpg"
      - base: "gpg2"
      - base: "gpg-agent"
      - base: "pinentry*"
      - base: "pass"

  - pattern: "~/.gnupg/secring.gpg"
    allow:
      - base: "gpg"
      - base: "gpg2"
      - base: "gpg-agent"

  # Package Manager Credentials
  - pattern: "~/.npmrc"
    allow:
      - base: "npm"
      - base: "node"
      - base: "yarn"
      - base: "pnpm"

  - pattern: "~/.pypirc"
    allow:
      - base: "python"
      - base: "python3"
      - base: "pip"
      - base: "pip3"
      - base: "twine"
        path_pattern: "~/.local/bin/*"

  - pattern: "~/.cargo/credentials"
    allow:
      - base: "cargo"
        path_pattern: "~/.cargo/bin/*"
      - base: "rustc"
        path_pattern: "~/.cargo/bin/*"
      - base: "rustup"
        path_pattern: "~/.cargo/bin/*"

  - pattern: "~/.docker/config.json"
    allow:
      - base: "docker"
      - base: "docker-compose"
      - base: "docker-credential-desktop"
      # Docker Desktop GUI app
      - base: "Docker"
        team_id: "9BNSXJN65R"  # Docker Inc
        ppid: 1

  # Kubernetes
  - pattern: "~/.kube/config"
    allow:
      - base: "kubectl"
      - base: "helm"
      - base: "k9s"
      - base: "minikube"
      # Lens GUI app
      - team_id: "R6H3FQGQ9K"  # Mirantis (Lens)
        ppid: 1

  # Browser Password Stores - Firefox
  - pattern: "~/Library/Application Support/Firefox/Profiles/*/logins.json"
    allow:
      # Firefox GUI apps must have ppid=1
      - base: "firefox"
        team_id: "43AQ936H96"  # Mozilla
        ppid: 1
      - base: "Firefox"
        team_id: "43AQ936H96"
        ppid: 1
      # Safari import service (system process)
      - base: "com.apple.Safari.BrowserDataImportingService"
        app_id: "com.apple.*"

  - pattern: "~/Library/Application Support/Firefox/Profiles/*/key*.db"
    allow:
      - base: "firefox"
        team_id: "43AQ936H96"
        ppid: 1
      - base: "Firefox"
        team_id: "43AQ936H96"
        ppid: 1
      - base: "com.apple.Safari.BrowserDataImportingService"
        app_id: "com.apple.*"

  - pattern: "~/Library/Application Support/Firefox/Profiles/*/cookies.sqlite"
    allow:
      - base: "firefox"
        team_id: "43AQ936H96"
        ppid: 1
      - base: "Firefox"
        team_id: "43AQ936H96"
        ppid: 1
      - base: "com.apple.Safari.BrowserDataImportingService"
        app_id: "com.apple.*"

  # Zen Browser (Firefox-based)
  - pattern: "~/Library/Application Support/Zen/Profiles/*/logins.json"
    allow:
      - base: "zen"
        team_id: "9V5K9TP787"  # Zen Browser
        ppid: 1
      - base: "Zen"
        team_id: "9V5K9TP787"
        ppid: 1

  - pattern: "~/Library/Application Support/Zen/Profiles/*/key*.db"
    allow:
      - base: "zen"
        team_id: "9V5K9TP787"
        ppid: 1
      - base: "Zen"
        team_id: "9V5K9TP787"
        ppid: 1

  - pattern: "~/Library/Application Support/Zen/Profiles/*/cookies.sqlite"
    allow:
      - base: "zen"
        team_id: "9V5K9TP787"
        ppid: 1
      - base: "Zen"
        team_id: "9V5K9TP787"
        ppid: 1

  - pattern: "~/Library/Application Support/Zen/Profiles/*/places.sqlite"
    allow:
      - base: "zen"
        team_id: "9V5K9TP787"
        ppid: 1
      - base: "Zen"
        team_id: "9V5K9TP787"
        ppid: 1

  - pattern: "~/Library/Application Support/Zen/Profiles/*/formhistory.sqlite"
    allow:
      - base: "zen"
        team_id: "9V5K9TP787"
        ppid: 1
      - base: "Zen"
        team_id: "9V5K9TP787"
        ppid: 1

  - pattern: "~/Library/Application Support/Zen/Profiles/*/signons.sqlite"
    allow:
      - base: "zen"
        team_id: "9V5K9TP787"
        ppid: 1
      - base: "Zen"
        team_id: "9V5K9TP787"
        ppid: 1

  - pattern: "~/Library/Application Support/Zen/Profiles/*/cert*.db"
    allow:
      - base: "zen"
        team_id: "9V5K9TP787"
        ppid: 1
      - base: "Zen"
        team_id: "9V5K9TP787"
        ppid: 1

  # Browser Password Stores - Chrome
  - pattern: "~/Library/Application Support/Google/Chrome/*/Login Data"
    allow:
      - base: "Google Chrome"
        team_id: "EQHXZ8M8AV"  # Google
        ppid: 1

  - pattern: "~/Library/Application Support/Google/Chrome/*/Cookies"
    allow:
      - base: "Google Chrome"
        team_id: "EQHXZ8M8AV"
        ppid: 1

  - pattern: "~/Library/Application Support/Google/Chrome/*/Web Data"
    allow:
      - base: "Google Chrome"
        team_id: "EQHXZ8M8AV"
        ppid: 1

  - pattern: "~/Library/Application Support/Google/Chrome/*/History"
    allow:
      - base: "Google Chrome"
        team_id: "EQHXZ8M8AV"
        ppid: 1

  - pattern: "~/Library/Application Support/Google/Chrome/*/Network/Cookies"
    allow:
      - base: "Google Chrome"
        team_id: "EQHXZ8M8AV"
        ppid: 1

  # Chrome Beta
  - pattern: "~/Library/Application Support/Google/Chrome Beta/*/Login Data"
    allow:
      - base: "Google Chrome Beta"
        team_id: "EQHXZ8M8AV"
        ppid: 1

  - pattern: "~/Library/Application Support/Google/Chrome Beta/*/Cookies"
    allow:
      - base: "Google Chrome Beta"
        team_id: "EQHXZ8M8AV"
        ppid: 1

  - pattern: "~/Library/Application Support/Google/Chrome Beta/*/Web Data"
    allow:
      - base: "Google Chrome Beta"
        team_id: "EQHXZ8M8AV"
        ppid: 1

  - pattern: "~/Library/Application Support/Google/Chrome Beta/*/History"
    allow:
      - base: "Google Chrome Beta"
        team_id: "EQHXZ8M8AV"
        ppid: 1

  - pattern: "~/Library/Application Support/Google/Chrome Beta/*/Network/Cookies"
    allow:
      - base: "Google Chrome Beta"
        team_id: "EQHXZ8M8AV"
        ppid: 1

  # Chrome Canary
  - pattern: "~/Library/Application Support/Google/Chrome Canary/*/Login Data"
    allow:
      - base: "Google Chrome Canary"
        team_id: "EQHXZ8M8AV"
        ppid: 1

  - pattern: "~/Library/Application Support/Google/Chrome Canary/*/Cookies"
    allow:
      - base: "Google Chrome Canary"
        team_id: "EQHXZ8M8AV"
        ppid: 1

  - pattern: "~/Library/Application Support/Google/Chrome Canary/*/Web Data"
    allow:
      - base: "Google Chrome Canary"
        team_id: "EQHXZ8M8AV"
        ppid: 1

  - pattern: "~/Library/Application Support/Google/Chrome Canary/*/History"
    allow:
      - base: "Google Chrome Canary"
        team_id: "EQHXZ8M8AV"
        ppid: 1

  - pattern: "~/Library/Application Support/Google/Chrome Canary/*/Network/Cookies"
    allow:
      - base: "Google Chrome Canary"
        team_id: "EQHXZ8M8AV"
        ppid: 1

  # Chromium
  - pattern: "~/Library/Application Support/Chromium/*/Login Data"
    allow:
      - base: "Chromium"
        ppid: 1

  - pattern: "~/Library/Application Support/Chromium/*/Cookies"
    allow:
      - base: "Chromium"
        ppid: 1

  - pattern: "~/Library/Application Support/Chromium/*/Web Data"
    allow:
      - base: "Chromium"
        ppid: 1

  # Email Clients - macOS Mail
  - pattern: "~/Library/Mail/V*/MailData/Accounts.plist"
    allow:
      - base: "Mail"
        app_id: "com.apple.*"
        ppid: 1
      - base: "MailService"
        app_id: "com.apple.*"

  - pattern: "~/Library/Mail/V*/MailData/*/MessageData/*"
    allow:
      - base: "Mail"
        app_id: "com.apple.*"
        ppid: 1
      - base: "MailService"
        app_id: "com.apple.*"

  - pattern: "~/Library/Accounts/Accounts4.sqlite"
    allow:
      - base: "Mail"
        app_id: "com.apple.*"
        ppid: 1
      - base: "accountsd"
        app_id: "com.apple.*"
      - base: "SecurityAgent"
        app_id: "com.apple.*"

  - pattern: "~/Library/Containers/com.apple.mail/Data/Library/Mail/*"
    allow:
      - base: "Mail"
        app_id: "com.apple.*"
        ppid: 1

  # Microsoft Outlook
  - pattern: "~/Library/Group Containers/UBF8T346G9.Office/Outlook/Outlook 15 Profiles/Main Profile/Accounts/*"
    allow:
      - base: "Microsoft Outlook"
        team_id: "UBF8T346G9"  # Microsoft
        ppid: 1

  - pattern: "~/Library/Group Containers/UBF8T346G9.Office/Outlook/Outlook 15 Profiles/Main Profile/*.olk15Message"
    allow:
      - base: "Microsoft Outlook"
        team_id: "UBF8T346G9"
        ppid: 1

  # Spark Mail
  - pattern: "~/Library/Containers/com.readdle.smartemail-Mac/Data/Library/Application Support/Spark/Accounts.db"
    allow:
      - base: "Spark"
        team_id: "6Z8N55R3J2"  # Readdle
        ppid: 1
      - base: "Spark â€“ Email App by Readdle"
        team_id: "6Z8N55R3J2"
        ppid: 1

  # Thunderbird
  - pattern: "~/Library/Thunderbird/Profiles/*/logins.json"
    allow:
      - base: "Thunderbird"
        team_id: "43AQ936H96"  # Mozilla
        ppid: 1

  - pattern: "~/Library/Thunderbird/Profiles/*/cookies.sqlite"
    allow:
      - base: "Thunderbird"
        team_id: "43AQ936H96"
        ppid: 1

  - pattern: "~/Library/Thunderbird/Profiles/*/key*.db"
    allow:
      - base: "Thunderbird"
        team_id: "43AQ936H96"
        ppid: 1

  # Safari Extensions and Data
  - pattern: "~/Library/Safari/LocalStorage/*"
    allow:
      - base: "Safari"
        app_id: "com.apple.*"
        ppid: 1
      - base: "SafariServices"
        app_id: "com.apple.*"

  - pattern: "~/Library/Safari/Databases/*"
    allow:
      - base: "Safari"
        app_id: "com.apple.*"
        ppid: 1
      - base: "SafariServices"
        app_id: "com.apple.*"

  # macOS Keychain - Most permissive since many apps need it
  - pattern: "~/Library/Keychains/login.keychain-db"
    allow:
      # Apple system processes
      - app_id: "com.apple.*"

      # Any legitimate app from standard app locations with ppid=1
      - path_pattern: "/Applications/*/*.app/Contents/MacOS/*"
        ppid: 1
      - path_pattern: "/System/Applications/*/*.app/Contents/MacOS/*"
        ppid: 1
      - path_pattern: "~/Applications/*/*.app/Contents/MacOS/*"
        ppid: 1
      - path_pattern: "/Applications/Utilities/*/*.app/Contents/MacOS/*"
        ppid: 1

      # Homebrew Cask apps
      - path_pattern: "/opt/homebrew/Caskroom/*/*.app/Contents/MacOS/*"
        ppid: 1

      # Command-line tools that legitimately need keychain
      - base: "security"
      - base: "codesign"
      # Hardcoded path for Apple's security tool
      - path: "/usr/bin/security"

  - pattern: "~/Library/Keychains/*.keychain-db"
    allow:
      # Apple system processes
      - app_id: "com.apple.*"

      # Security tools
      - base: "security"
      - base: "Keychain Access"
        app_id: "com.apple.*"
        ppid: 1
      # Hardcoded path for Apple's security tool
      - path: "/usr/bin/security"

  # Password Managers
  - pattern: "~/.password-store/**/*.gpg"
    allow:
      - base: "pass"
      - base: "gpg"
      - base: "gpg2"
      - base: "passmenu"

  - pattern: "~/Documents/*.kdbx"
    allow:
      # KeePassXC GUI app
      - base: "keepassxc"
        team_id: "G2S7R7PVXJ"  # KeePassXC
        ppid: 1
      - base: "KeePassXC"
        team_id: "G2S7R7PVXJ"
        ppid: 1
      # Command-line tools
      - base: "kpcli"

  - pattern: "~/Library/Application Support/Bitwarden/data.json"
    allow:
      - base: "Bitwarden"
        team_id: "LTZ2PFU5D6"  # Bitwarden
        ppid: 1

  # Cryptocurrency Wallets
  - pattern: "~/Library/Application Support/Bitcoin/wallet.dat"
    allow:
      - base: "Bitcoin-Qt"
        ppid: 1
      - base: "bitcoin-cli"

  - pattern: "~/Library/Application Support/Ethereum/keystore/*"
    allow:
      - base: "geth"
      - base: "Mist"
        ppid: 1

  - pattern: "~/Library/Application Support/Electrum/wallets/*"
    allow:
      - base: "Electrum"
        ppid: 1

  - pattern: "~/Library/Application Support/exodus/exodus.wallet/*"
    allow:
      - base: "Exodus"
        ppid: 1

  - pattern: "~/Library/Application Support/atomic/Local Storage/leveldb/*"
    allow:
      - base: "Atomic Wallet"
        ppid: 1

  # Discord Token
  - pattern: "~/Library/Application Support/discord/Local Storage/leveldb/*"
    allow:
      - base: "Discord"
        team_id: "53Q6R32WPB"  # Discord
        ppid: 1

  # Slack
  - pattern: "~/Library/Application Support/Slack/Cookies"
    allow:
      - base: "Slack"
        team_id: "BQR82RAZA8"  # Slack
        ppid: 1

  - pattern: "~/Library/Application Support/Slack/Local Storage/leveldb/*"
    allow:
      - base: "Slack"
        team_id: "BQR82RAZA8"
        ppid: 1

  # Telegram
  - pattern: "~/Library/Application Support/Telegram Desktop/tdata/*"
    allow:
      - base: "Telegram Desktop"
        ppid: 1
      - base: "Telegram"
        ppid: 1

  # Signal
  - pattern: "~/Library/Application Support/Signal/sql/db.sqlite"
    allow:
      - base: "Signal"
        team_id: "U68MSDN6DR"  # Signal
        ppid: 1

  - pattern: "~/Library/Application Support/Signal/config.json"
    allow:
      - base: "Signal"
        team_id: "U68MSDN6DR"
        ppid: 1

  # Brave Browser
  - pattern: "~/Library/Application Support/BraveSoftware/Brave-Browser/*/Login Data"
    allow:
      - base: "Brave Browser"
        team_id: "KL8N8XSYF4"  # Brave
        ppid: 1

  - pattern: "~/Library/Application Support/BraveSoftware/Brave-Browser/*/Cookies"
    allow:
      - base: "Brave Browser"
        team_id: "KL8N8XSYF4"
        ppid: 1

  # Edge Browser
  - pattern: "~/Library/Application Support/Microsoft Edge/*/Login Data"
    allow:
      - base: "Microsoft Edge"
        team_id: "UBF8T346G9"  # Microsoft
        ppid: 1

  - pattern: "~/Library/Application Support/Microsoft Edge/*/Cookies"
    allow:
      - base: "Microsoft Edge"
        team_id: "UBF8T346G9"
        ppid: 1

  # Opera Browser
  - pattern: "~/Library/Application Support/com.operasoftware.Opera/Login Data"
    allow:
      - base: "Opera"
        team_id: "A2P9LX4JPN"  # Opera
        ppid: 1

  - pattern: "~/Library/Application Support/com.operasoftware.Opera/Cookies"
    allow:
      - base: "Opera"
        team_id: "A2P9LX4JPN"
        ppid: 1

  # FileZilla
  - pattern: "~/.config/filezilla/recentservers.xml"
    allow:
      - base: "filezilla"
        ppid: 1
      - base: "FileZilla"
        ppid: 1

  - pattern: "~/.config/filezilla/sitemanager.xml"
    allow:
      - base: "filezilla"
        ppid: 1
      - base: "FileZilla"
        ppid: 1

  # Authy Desktop
  - pattern: "~/Library/Application Support/Authy Desktop/Local Storage/leveldb/*"
    allow:
      - base: "Authy Desktop"
        team_id: "9EVH9FK6WT"  # Twilio
        ppid: 1

  # Steam
  - pattern: "~/Library/Application Support/Steam/config/loginusers.vdf"
    allow:
      - base: "steam"
        ppid: 1
      - base: "Steam"
        team_id: "MXGJJ98X76"  # Valve
        ppid: 1

  # Battle.net
  - pattern: "~/Library/Application Support/Battle.net/Account/*"
    allow:
      - base: "Battle.net"
        team_id: "L2JLF47G6D"  # Blizzard
        ppid: 1

  # Notion
  - pattern: "~/Library/Application Support/Notion/notion.db"
    allow:
      - base: "Notion"
        team_id: "LBQJ96R89F"  # Notion
        ppid: 1

  # TablePlus
  - pattern: "~/Library/Application Support/com.tinyapp.TablePlus/Data/Connections.plist"
    allow:
      - base: "TablePlus"
        team_id: "3X57WD8ENQ"  # TablePlus
        ppid: 1

  # Sequel Pro
  - pattern: "~/Library/Application Support/Sequel Pro/Data/Favorites.plist"
    allow:
      - base: "Sequel Pro"
        ppid: 1

  # DBeaver
  - pattern: "~/.dbeaver/credentials-config.json"
    allow:
      - base: "dbeaver"
        ppid: 1
      - base: "DBeaver"
        ppid: 1

  # Postman
  - pattern: "~/Library/Application Support/Postman/storage/*"
    allow:
      - base: "Postman"
        team_id: "H7LP8A9S8Q"  # Postman
        ppid: 1

  # Insomnia
  - pattern: "~/Library/Application Support/Insomnia/insomnia.*.db"
    allow:
      - base: "Insomnia"
        team_id: "FX44YY62GV"  # Kong
        ppid: 1

  # RDP Connection Files
  - pattern: "~/Documents/*.rdp"
    allow:
      - base: "Microsoft Remote Desktop"
        team_id: "UBF8T346G9"  # Microsoft
        ppid: 1

  # VPN Configurations
  - pattern: "~/Library/Application Support/Viscosity/OpenVPN/*"
    allow:
      - base: "Viscosity"
        team_id: "34XR7GXFPX"  # SparkLabs
        ppid: 1

  - pattern: "~/Library/Application Support/Tunnelblick/Configurations/*"
    allow:
      - base: "Tunnelblick"
        ppid: 1

  # Cyberduck
  - pattern: "~/Library/Group Containers/G69SCX94XU.duck/Library/Application Support/duck/Bookmarks/*"
    allow:
      - base: "Cyberduck"
        team_id: "G69SCX94XU"  # iterate
        ppid: 1

  # Transmit
  - pattern: "~/Library/Application Support/Transmit/Favorites/*"
    allow:
      - base: "Transmit"
        team_id: "VE8FC488U5"  # Panic
        ppid: 1

  # GitHub Desktop
  - pattern: "~/Library/Application Support/GitHub Desktop/storage/userData.json"
    allow:
      - base: "GitHub Desktop"
        team_id: "VEKTX9H2N7"  # GitHub
        ppid: 1

  # SourceTree
  - pattern: "~/Library/Application Support/SourceTree/accounts.json"
    allow:
      - base: "SourceTree"
        team_id: "UPXU4CQZ5P"  # Atlassian
        ppid: 1

  # GitKraken
  - pattern: "~/.gitkraken/profiles/*"
    allow:
      - base: "GitKraken"
        team_id: "HV6GQZR9ZK"  # Axosoft
        ppid: 1

  # Shell History Files
  - pattern: "~/.bash_history"
    allow:
      - base: "bash"
      - base: "sh"

  - pattern: "~/.zsh_history"
    allow:
      - base: "zsh"
      - base: "sh"

  - pattern: "~/.history"
    allow:
      - base: "csh"
      - base: "tcsh"
      - base: "sh"

  - pattern: "~/.fish_history"
    allow:
      - base: "fish"

  - pattern: "~/.local/share/fish/fish_history"
    allow:
      - base: "fish"

  # PowerShell History
  - pattern: "~/.local/share/powershell/PSReadLine/ConsoleHost_history.txt"
    allow:
      - base: "pwsh"
      - base: "powershell"
        path_pattern: "/usr/local/microsoft/powershell/*/pwsh"
        team_id: "UBF8T346G9"  # Microsoft

  # Environment files
  - pattern: "~/.env"
    allow:
      # VS Code
      - base: "code"
        team_id: "UBF8T346G9"  # Microsoft
      # Command-line editors
      - base: "vim"
      - base: "nvim"
      - base: "emacs"
      - base: "nano"

  - pattern: "~/*/.env"
    allow:
      - base: "code"
        team_id: "UBF8T346G9"
      - base: "vim"
      - base: "nvim"
      - base: "node"
      - base: "python"
      - base: "python3"

  - pattern: "~/*/.env.local"
    allow:
      - base: "code"
        team_id: "UBF8T346G9"
      - base: "vim"
      - base: "nvim"
      - base: "node"
      - base: "python"
      - base: "python3"

  # GitHub CLI
  - pattern: "~/.config/gh/hosts.yml"
    allow:
      - base: "gh"

      # GitHub CLI from Homebrew Cellar (versioned paths)
      - base: "gh"
        path_pattern: "/opt/homebrew/Cellar/gh/*/bin/*"

  # Network authentication files
  - pattern: "~/.netrc"
    allow:
      # Cloud CLIs
      - base: "heroku"
      # Network tools
      - base: "curl"
      - base: "wget"
      - base: "ftp"
      - base: "git"
      - base: "lftp"
      # Email clients
      - base: "mutt"
      - base: "pine"
      - base: "alpine"
      # Command-line editors (may edit the file)
      - base: "vim"
      - base: "nvim"
      - base: "emacs"
      - base: "nano"

  # Netlify CLI
  - pattern: "~/.netlify/config.json"
    allow:
      - base: "netlify"
      - base: "ntl"

  # Vercel CLI
  - pattern: "~/.vercel/auth.json"
    allow:
      - base: "vercel"
      - base: "vc"

  # Linux-specific paths (keeping legacy format for Linux compatibility)
  - pattern: "~/.local/share/keyrings/*.keyring"
    allow:
      - base: "gnome-keyring-daemon"
      - base: "seahorse"
      - base: "secret-tool"

  - pattern: "~/.config/google-chrome/*/Login Data"
    allow:
      - base: "chrome"
      - base: "google-chrome"
      - base: "google-chrome-stable"

  - pattern: "~/.config/google-chrome/*/Cookies"
    allow:
      - base: "chrome"
      - base: "google-chrome"
      - base: "google-chrome-stable"

  # Chrome Beta on Linux
  - pattern: "~/.config/google-chrome-beta/*/Login Data"
    allow:
      - base: "chrome-beta"
      - base: "google-chrome-beta"

  - pattern: "~/.config/google-chrome-beta/*/Cookies"
    allow:
      - base: "chrome-beta"
      - base: "google-chrome-beta"

  - pattern: "~/.config/google-chrome-beta/*/Web Data"
    allow:
      - base: "chrome-beta"
      - base: "google-chrome-beta"

  # Chrome Dev/Canary on Linux (called 'unstable')
  - pattern: "~/.config/google-chrome-unstable/*/Login Data"
    allow:
      - base: "chrome-unstable"
      - base: "google-chrome-unstable"

  - pattern: "~/.config/google-chrome-unstable/*/Cookies"
    allow:
      - base: "chrome-unstable"
      - base: "google-chrome-unstable"

  - pattern: "~/.config/google-chrome-unstable/*/Web Data"
    allow:
      - base: "chrome-unstable"
      - base: "google-chrome-unstable"

  - pattern: "~/.mozilla/firefox/*/logins.json"
    allow:
      - base: "firefox"
      - base: "firefox-bin"

  - pattern: "~/.mozilla/firefox/*/cookies.sqlite"
    allow:
      - base: "firefox"
      - base: "firefox-bin"

  # Zen Browser on Linux
  - pattern: "~/.zen/*/profiles/*/logins.json"
    allow:
      - base: "zen"
      - base: "zen-browser"

  - pattern: "~/.zen/*/profiles/*/key*.db"
    allow:
      - base: "zen"
      - base: "zen-browser"

  - pattern: "~/.zen/*/profiles/*/cookies.sqlite"
    allow:
      - base: "zen"
      - base: "zen-browser"

  - pattern: "~/.config/zen/*/profiles/*/logins.json"
    allow:
      - base: "zen"
      - base: "zen-browser"

  - pattern: "~/.config/zen/*/profiles/*/key*.db"
    allow:
      - base: "zen"
      - base: "zen-browser"

  - pattern: "~/.config/zen/*/profiles/*/cookies.sqlite"
    allow:
      - base: "zen"
      - base: "zen-browser"

  - pattern: "~/.thunderbird/*/logins.json"
    allow:
      - base: "thunderbird"

  - pattern: "~/.config/discord/Local Storage/leveldb/*"
    allow:
      - base: "discord"
      - base: "Discord"

  - pattern: "~/.config/Slack/Cookies"
    allow:
      - base: "slack"

  - pattern: "~/.config/Code/User/globalStorage/*"
    allow:
      - base: "code"
      - base: "code-oss"

  # Linux server secrets (actual credentials/private keys)
  - pattern: "/etc/shadow"
    allow:
      # System authentication tools
      - base: "passwd"
      - base: "chpasswd"
      - base: "usermod"
      - base: "vipw"
      - base: "pwck"
      # PAM modules
      - team_id: "system"
        uid: 0

  - pattern: "/etc/gshadow"
    allow:
      - base: "gpasswd"
      - base: "vigr"
      - base: "grpck"
      - team_id: "system"
        uid: 0

  - pattern: "/etc/ssh/ssh_host_*_key"
    allow:
      - base: "sshd"
      - base: "ssh-keygen"
      - team_id: "system"
        uid: 0

  - pattern: "/etc/ssl/private/*"
    allow:
      # Web servers
      - base: "nginx"
      - base: "apache2"
      - base: "httpd"
      # Load balancers
      - base: "haproxy"
      # System SSL tools
      - base: "openssl"
      - team_id: "system"
        uid: 0

  - pattern: "/etc/pki/private/*"
    allow:
      - base: "nginx"
      - base: "apache2"
      - base: "httpd"
      - base: "haproxy"
      - base: "openssl"
      - team_id: "system"
        uid: 0

  - pattern: "/root/.ssh/id_*"
    allow:
      - base: "ssh"
      - base: "ssh-add"
      - base: "ssh-agent"
      - base: "ssh-keygen"
      - base: "scp"
      - base: "rsync"
      - uid: 0

  - pattern: "/home/*/.ssh/id_*"
    allow:
      - base: "ssh"
      - base: "ssh-add"
      - base: "ssh-agent"
      - base: "ssh-keygen"
      - base: "scp"
      - base: "rsync"

  - pattern: "/etc/mysql/debian.cnf"
    allow:
      - base: "mysql"
      - base: "mysqld"
      - base: "mariadb"
      - team_id: "system"
        uid: 0

  - pattern: "/var/lib/postgresql/.pgpass"
    allow:
      - base: "postgres"
      - base: "psql"
      - base: "pg_dump"
      - base: "pg_restore"

# Patterns to exclude from monitoring (reduce noise)
excluded_patterns:
  - "*.pub"           # Public keys
  - "*.public"        # Public files
  - "*/.git/*"        # Git internals
  - "*/node_modules/*" # Node modules
  - "*/__pycache__/*" # Python cache
  - "*/target/*"      # Rust/Cargo build
  - "*.log"           # Log files
  - "*.tmp"           # Temporary files

# Platform-specific default paths for base-only rules
default_base_paths:
  macos:
    - /usr/bin
    - /bin
    - /usr/sbin
    - /sbin
    - /System/Library
    - /usr/local/bin
    - /usr/local/sbin
    - /opt/homebrew/bin
    - /opt/homebrew/sbin
    - /opt/homebrew/Cellar/*/bin
    - /opt/homebrew/Cellar/*/sbin
    - /Applications/*/Contents/MacOS
    - ~/Applications/*/Contents/MacOS
    - /System/Applications/*/Contents/MacOS

  linux:
    - /usr/bin
    - /bin
    - /usr/sbin
    - /sbin
    - /usr/local/bin
    - /usr/local/sbin
    - /opt/*/bin
    - /snap/bin
    - /var/lib/flatpak/exports/bin
    - ~/.local/bin

  freebsd:
    - /usr/bin
    - /bin
    - /usr/sbin
    - /sbin
    - /usr/local/bin
    - /usr/local/sbin
    - /usr/pkg/bin
    - /usr/pkg/sbin
    - /usr/ports/*/work/stage/usr/local/bin
    - ~/.local/bin
    - /usr/home/*/.cargo/bin
    - /usr/home/*/go/bin

  netbsd:
    - /usr/bin
    - /bin
    - /usr/sbin
    - /sbin
    - /usr/pkg/bin
    - /usr/pkg/sbin
    - /usr/X11R7/bin
    - ~/.local/bin
    - /home/*/.cargo/bin
    - /home/*/go/bin

  openbsd:
    - /usr/bin
    - /bin
    - /usr/sbin
    - /sbin
    - /usr/local/bin
    - /usr/local/sbin
    - /usr/X11R6/bin
    - ~/.local/bin
    - /home/*/.cargo/bin
    - /home/*/go/bin

  illumos:
    - /usr/bin
    - /bin
    - /usr/sbin
    - /sbin
    - /opt/local/bin
    - /opt/local/sbin
    - /usr/gnu/bin
    - /opt/ooce/bin
    - ~/.local/bin
    - /export/home/*/.cargo/bin
    - /export/home/*/go/bin

  solaris:
    - /usr/bin
    - /bin
    - /usr/sbin
    - /sbin
    - /opt/csw/bin
    - /opt/csw/sbin
    - /usr/sfw/bin
    - /usr/gnu/bin
    - ~/.local/bin
    - /export/home/*/.cargo/bin
    - /export/home/*/go/bin

# Monitoring configuration
monitoring:
  # Paths to monitor (Linux fanotify)
  watch_paths:
    - /home
    - /root

  # Event buffer size
  buffer_size: 8192

  # Maximum events per second (rate limiting)
  max_events_per_sec: 10000

