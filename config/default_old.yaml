# NoSwiper Default Configuration
# This file is embedded at compile time and provides the default rules
# Users can override these with ~/.config/noswiper/config.yaml

# Files and patterns to protect
protected_files:
  # SSH Keys
  - pattern: "~/.ssh/id_*"
    allowed_programs:
      - ssh
      - ssh-add
      - ssh-agent
      - ssh-keygen
      - scp
      - sftp
      - rsync
      - git
      - git-remote-https
      - gh
    allowed_signers:
      - "com.apple.Terminal"
      - "com.googlecode.iterm2"
      - "com.microsoft.VSCode"
      - "dev.warp.Warp"

  - pattern: "~/.ssh/*_key"
    allowed_programs:
      - ssh
      - ssh-add
      - ssh-agent
      - ssh-keygen
      - scp
      - sftp
      - rsync
      - git
    allowed_signers:
      - "com.apple.Terminal"
      - "com.googlecode.iterm2"

  # AWS Credentials
  - pattern: "~/.aws/credentials"
    allowed_programs:
      - aws
      - terraform
      - ansible
      - ansible-playbook
      - packer
      - boto
      - python
      - python3
    allowed_signers:
      - "HashiCorp"  # Terraform team ID
      - "com.amazon.AWS-CLI"

  - pattern: "~/.aws/config"
    allowed_programs:
      - aws
      - terraform
      - ansible
      - packer
    allowed_signers:
      - "HashiCorp"

  # Google Cloud
  - pattern: "~/.config/gcloud/credentials.db"
    allowed_programs:
      - gcloud
      - gsutil
      - bq
      - kubectl
      - python
      - python3
      - Python  # macOS Python wrapper
    allowed_signers:
      - "EQHXZ8M8AV"  # Google team ID
      - "com.apple.python3"  # System Python used by gcloud

  - pattern: "~/.config/gcloud/access_tokens.db"
    allowed_programs:
      - gcloud
      - gsutil
      - bq
      - python
      - python3
      - Python  # macOS Python wrapper
    allowed_signers:
      - "EQHXZ8M8AV"  # Google team ID
      - "com.apple.python3"  # System Python used by gcloud

  # Azure
  - pattern: "~/.azure/accessTokens.json"
    allowed_programs:
      - az
      - azure-cli
      - powershell
    allowed_signers:
      - "UBF8T346G9"  # Microsoft team ID

  # GPG Keys
  - pattern: "~/.gnupg/private-keys*"
    allowed_programs:
      - gpg
      - gpg2
      - gpg-agent
      - pinentry
      - pass
    allowed_signers:
      - "org.gpgtools.gpg"

  - pattern: "~/.gnupg/secring.gpg"
    allowed_programs:
      - gpg
      - gpg2
      - gpg-agent

  # Package Manager Credentials
  - pattern: "~/.npmrc"
    allowed_programs:
      - npm
      - node
      - yarn
      - pnpm
    allowed_signers:
      - "com.nodejs.node"

  - pattern: "~/.pypirc"
    allowed_programs:
      - python
      - python3
      - pip
      - pip3
      - twine

  - pattern: "~/.cargo/credentials"
    allowed_programs:
      - cargo
      - rustc
      - rustup

  - pattern: "~/.docker/config.json"
    allowed_programs:
      - docker
      - docker-compose
      - docker-credential-desktop
      - Docker
    allowed_signers:
      - "com.docker.Docker"

  # Kubernetes
  - pattern: "~/.kube/config"
    allowed_programs:
      - kubectl
      - helm
      - k9s
      - lens
      - minikube
    allowed_signers:
      - "io.k8slens.lens"

  # Browser Password Stores - Firefox
  - pattern: "~/Library/Application Support/Firefox/Profiles/*/logins.json"
    allowed_programs:
      - firefox
      - Firefox
      - "com.apple.Safari.BrowserDataImportingService"  # Safari's import feature
    allowed_signers:
      - "org.mozilla.firefox"
      - "org.mozilla.firefoxdeveloperedition"  # Firefox Developer Edition
      - "43AQ936H96"  # Mozilla team ID
      - "com.apple.Safari.BrowserDataImportingService"  # Safari import service

  - pattern: "~/Library/Application Support/Firefox/Profiles/*/key*.db"
    allowed_programs:
      - firefox
      - Firefox
      - "com.apple.Safari.BrowserDataImportingService"  # Safari's import feature
    allowed_signers:
      - "org.mozilla.firefox"
      - "org.mozilla.firefoxdeveloperedition"  # Firefox Developer Edition
      - "43AQ936H96"  # Mozilla team ID
      - "com.apple.Safari.BrowserDataImportingService"  # Safari import service

  - pattern: "~/Library/Application Support/Firefox/Profiles/*/cookies.sqlite"
    allowed_programs:
      - firefox
      - Firefox
      - "com.apple.Safari.BrowserDataImportingService"  # Safari's import feature
    allowed_signers:
      - "org.mozilla.firefox"
      - "org.mozilla.firefoxdeveloperedition"  # Firefox Developer Edition
      - "43AQ936H96"  # Mozilla team ID
      - "com.apple.Safari.BrowserDataImportingService"  # Safari import service

  # Zen Browser (Firefox-based)
  - pattern: "~/Library/Application Support/Zen/Profiles/*/logins.json"
    allowed_programs:
      - zen
      - Zen
    allowed_signers:
      - "app.zen-browser.zen"
      - "9V5K9TP787"  # Zen Browser team ID

  - pattern: "~/Library/Application Support/Zen/Profiles/*/key*.db"
    allowed_programs:
      - zen
      - Zen
    allowed_signers:
      - "app.zen-browser.zen"
      - "9V5K9TP787"  # Zen Browser team ID

  - pattern: "~/Library/Application Support/Zen/Profiles/*/cookies.sqlite"
    allowed_programs:
      - zen
      - Zen
    allowed_signers:
      - "app.zen-browser.zen"
      - "9V5K9TP787"  # Zen Browser team ID

  - pattern: "~/Library/Application Support/Zen/Profiles/*/places.sqlite"
    allowed_programs:
      - zen
      - Zen
    allowed_signers:
      - "app.zen-browser.zen"
      - "9V5K9TP787"  # Zen Browser team ID

  - pattern: "~/Library/Application Support/Zen/Profiles/*/formhistory.sqlite"
    allowed_programs:
      - zen
      - Zen
    allowed_signers:
      - "app.zen-browser.zen"
      - "9V5K9TP787"  # Zen Browser team ID

  - pattern: "~/Library/Application Support/Zen/Profiles/*/signons.sqlite"
    allowed_programs:
      - zen
      - Zen
    allowed_signers:
      - "app.zen-browser.zen"
      - "9V5K9TP787"  # Zen Browser team ID

  - pattern: "~/Library/Application Support/Zen/Profiles/*/cert*.db"
    allowed_programs:
      - zen
      - Zen
    allowed_signers:
      - "app.zen-browser.zen"
      - "9V5K9TP787"  # Zen Browser team ID

  # Browser Password Stores - Chrome
  - pattern: "~/Library/Application Support/Google/Chrome/*/Login Data"
    allowed_programs:
      - "Google Chrome"
      - chrome
    allowed_signers:
      - "com.google.Chrome"

  - pattern: "~/Library/Application Support/Google/Chrome/*/Cookies"
    allowed_programs:
      - "Google Chrome"
      - chrome
    allowed_signers:
      - "com.google.Chrome"

  - pattern: "~/Library/Application Support/Google/Chrome/*/Web Data"
    allowed_programs:
      - "Google Chrome"
      - chrome
    allowed_signers:
      - "com.google.Chrome"

  - pattern: "~/Library/Application Support/Google/Chrome/*/History"
    allowed_programs:
      - "Google Chrome"
      - chrome
    allowed_signers:
      - "com.google.Chrome"

  - pattern: "~/Library/Application Support/Google/Chrome/*/Network/Cookies"
    allowed_programs:
      - "Google Chrome"
      - chrome
    allowed_signers:
      - "com.google.Chrome"

  # Chrome Beta
  - pattern: "~/Library/Application Support/Google/Chrome Beta/*/Login Data"
    allowed_programs:
      - "Google Chrome Beta"
      - chrome-beta
    allowed_signers:
      - "com.google.Chrome.beta"
      - "EQHXZ8M8AV"  # Google team ID

  - pattern: "~/Library/Application Support/Google/Chrome Beta/*/Cookies"
    allowed_programs:
      - "Google Chrome Beta"
      - chrome-beta
    allowed_signers:
      - "com.google.Chrome.beta"
      - "EQHXZ8M8AV"  # Google team ID

  - pattern: "~/Library/Application Support/Google/Chrome Beta/*/Web Data"
    allowed_programs:
      - "Google Chrome Beta"
      - chrome-beta
    allowed_signers:
      - "com.google.Chrome.beta"
      - "EQHXZ8M8AV"  # Google team ID

  - pattern: "~/Library/Application Support/Google/Chrome Beta/*/History"
    allowed_programs:
      - "Google Chrome Beta"
      - chrome-beta
    allowed_signers:
      - "com.google.Chrome.beta"
      - "EQHXZ8M8AV"  # Google team ID

  - pattern: "~/Library/Application Support/Google/Chrome Beta/*/Network/Cookies"
    allowed_programs:
      - "Google Chrome Beta"
      - chrome-beta
    allowed_signers:
      - "com.google.Chrome.beta"
      - "EQHXZ8M8AV"  # Google team ID

  # Chrome Canary
  - pattern: "~/Library/Application Support/Google/Chrome Canary/*/Login Data"
    allowed_programs:
      - "Google Chrome Canary"
      - chrome-canary
    allowed_signers:
      - "com.google.Chrome.canary"
      - "EQHXZ8M8AV"  # Google team ID

  - pattern: "~/Library/Application Support/Google/Chrome Canary/*/Cookies"
    allowed_programs:
      - "Google Chrome Canary"
      - chrome-canary
    allowed_signers:
      - "com.google.Chrome.canary"
      - "EQHXZ8M8AV"  # Google team ID

  - pattern: "~/Library/Application Support/Google/Chrome Canary/*/Web Data"
    allowed_programs:
      - "Google Chrome Canary"
      - chrome-canary
    allowed_signers:
      - "com.google.Chrome.canary"
      - "EQHXZ8M8AV"  # Google team ID

  - pattern: "~/Library/Application Support/Google/Chrome Canary/*/History"
    allowed_programs:
      - "Google Chrome Canary"
      - chrome-canary
    allowed_signers:
      - "com.google.Chrome.canary"
      - "EQHXZ8M8AV"  # Google team ID

  - pattern: "~/Library/Application Support/Google/Chrome Canary/*/Network/Cookies"
    allowed_programs:
      - "Google Chrome Canary"
      - chrome-canary
    allowed_signers:
      - "com.google.Chrome.canary"
      - "EQHXZ8M8AV"  # Google team ID

  # Chromium variants (macOS)
  - pattern: "~/Library/Application Support/Chromium/*/Login Data"
    allowed_programs:
      - Chromium
      - chromium
    allowed_signers:
      - "org.chromium.Chromium"

  - pattern: "~/Library/Application Support/Chromium/*/Cookies"
    allowed_programs:
      - Chromium
      - chromium
    allowed_signers:
      - "org.chromium.Chromium"

  - pattern: "~/Library/Application Support/Chromium/*/Web Data"
    allowed_programs:
      - Chromium
      - chromium
    allowed_signers:
      - "org.chromium.Chromium"

  # Email Clients - macOS Mail
  - pattern: "~/Library/Mail/V*/MailData/Accounts.plist"
    allowed_programs:
      - Mail
      - MailService
    allowed_signers:
      - "com.apple.mail"
      - "com.apple.MailServiceAgent"

  - pattern: "~/Library/Mail/V*/MailData/*/MessageData/*"
    allowed_programs:
      - Mail
      - MailService
    allowed_signers:
      - "com.apple.mail"
      - "com.apple.MailServiceAgent"

  - pattern: "~/Library/Accounts/Accounts4.sqlite"
    allowed_programs:
      - Mail
      - accountsd
      - SecurityAgent
    allowed_signers:
      - "com.apple.mail"
      - "com.apple.accountsd"
      - "com.apple.SecurityAgent"

  - pattern: "~/Library/Containers/com.apple.mail/Data/Library/Mail/*"
    allowed_programs:
      - Mail
    allowed_signers:
      - "com.apple.mail"

  # Microsoft Outlook
  - pattern: "~/Library/Group Containers/UBF8T346G9.Office/Outlook/Outlook 15 Profiles/Main Profile/Accounts/*"
    allowed_programs:
      - "Microsoft Outlook"
      - Outlook
    allowed_signers:
      - "UBF8T346G9"  # Microsoft team ID

  - pattern: "~/Library/Group Containers/UBF8T346G9.Office/Outlook/Outlook 15 Profiles/Main Profile/*.olk15Message"
    allowed_programs:
      - "Microsoft Outlook"
      - Outlook
    allowed_signers:
      - "UBF8T346G9"  # Microsoft team ID

  # Spark Mail
  - pattern: "~/Library/Containers/com.readdle.smartemail-Mac/Data/Library/Application Support/Spark/Accounts.db"
    allowed_programs:
      - Spark
      - "Spark â€“ Email App by Readdle"
    allowed_signers:
      - "com.readdle.smartemail-Mac"

  # Airmail
  - pattern: "~/Library/Containers/it.bloop.airmail*/Data/Library/Application Support/Airmail/Accounts.db"
    allowed_programs:
      - Airmail
      - "Airmail 5"
    allowed_signers:
      - "it.bloop.airmail"

  # Thunderbird
  - pattern: "~/Library/Thunderbird/Profiles/*/logins.json"
    allowed_programs:
      - Thunderbird
      - thunderbird
    allowed_signers:
      - "org.mozilla.thunderbird"

  - pattern: "~/Library/Thunderbird/Profiles/*/cookies.sqlite"
    allowed_programs:
      - Thunderbird
      - thunderbird
    allowed_signers:
      - "org.mozilla.thunderbird"

  - pattern: "~/Library/Thunderbird/Profiles/*/key*.db"
    allowed_programs:
      - Thunderbird
      - thunderbird
    allowed_signers:
      - "org.mozilla.thunderbird"

  # Canary Mail
  - pattern: "~/Library/Containers/io.canarymail.mac/Data/Library/Application Support/CanaryMail/accounts.db"
    allowed_programs:
      - "Canary Mail"
      - CanaryMail
    allowed_signers:
      - "io.canarymail.mac"

  # Newton Mail
  - pattern: "~/Library/Application Support/Newton/data/*"
    allowed_programs:
      - Newton
    allowed_signers:
      - "com.cloudmagic.newton"

  # Polymail
  - pattern: "~/Library/Application Support/Polymail/config.json"
    allowed_programs:
      - Polymail
    allowed_signers:
      - "com.polymail.osx"

  # Safari Extensions and Data
  - pattern: "~/Library/Safari/LocalStorage/*"
    allowed_programs:
      - Safari
      - SafariServices
    allowed_signers:
      - "com.apple.Safari"

  - pattern: "~/Library/Safari/Databases/*"
    allowed_programs:
      - Safari
      - SafariServices
    allowed_signers:
      - "com.apple.Safari"

  # macOS Keychain
  - pattern: "~/Library/Keychains/login.keychain-db"
    allowed_programs:
      - security
      - "Keychain Access"
      - SecurityAgent
      - codesign
      - accountsd
      - sharingd
      - cloudd
      - securityd
      - trustd
      - zed
    allowed_signers:
      # Apple system processes (all have com.apple.* signing IDs)
      - "com.apple.accountsd"
      - "com.apple.sharingd"
      - "com.apple.cloudd"
      - "com.apple.securityd"
      - "com.apple.trustd"
      - "com.apple.SecurityAgent"
      - "com.apple.security"
      - "com.apple.codesign"
      - "com.apple.Safari"
      # Third-party apps by team ID
      - "EQHXZ8M8AV"  # Google
      - "AXL7V72P4Y"  # Dropbox
      - "2BUA8C4S2C"  # 1Password
      - "LTZ2PFU5D6"  # Bitwarden
      - "44U7362S3E"  # LastPass
      - "6JSW4SJWN9"  # Dashlane
      - "43AQ936H96"  # Mozilla (Firefox Developer Edition)
      - "9V5K9TP787"  # Zen Browser
      - "MQ55VZLNZQ"  # Zed Editor

  - pattern: "~/Library/Keychains/*.keychain-db"
    allowed_programs:
      - security
      - "Keychain Access"
      - SecurityAgent
      - securityd
      - zed
    allowed_signers:
      - "com.apple.security"
      - "com.apple.SecurityAgent"
      - "com.apple.securityd"
      - "43AQ936H96"  # Mozilla (Firefox Developer Edition)
      - "9V5K9TP787"  # Zen Browser
      - "MQ55VZLNZQ"  # Zed Editor

  # Password Managers
  - pattern: "~/.password-store/**/*.gpg"
    allowed_programs:
      - pass
      - gpg
      - gpg2
      - passmenu

  - pattern: "~/Documents/*.kdbx"
    allowed_programs:
      - keepassxc
      - keepassx
      - keepass2
      - kpcli
    allowed_signers:
      - "G2S7R7PVXJ"  # KeePassXC team ID

  - pattern: "~/Library/Application Support/Bitwarden/data.json"
    allowed_programs:
      - Bitwarden
      - bitwarden
    allowed_signers:
      - "LTZ2PFU5D6"  # Bitwarden team ID

  # Cryptocurrency Wallets
  - pattern: "~/Library/Application Support/Bitcoin/wallet.dat"
    allowed_programs:
      - Bitcoin-Qt
      - bitcoin-cli
    allowed_signers:
      - "org.bitcoinfoundation.Bitcoin-Qt"

  - pattern: "~/Library/Application Support/Ethereum/keystore/*"
    allowed_programs:
      - geth
      - Mist
    allowed_signers:
      - "org.ethereum.mist"

  - pattern: "~/Library/Application Support/Electrum/wallets/*"
    allowed_programs:
      - Electrum
    allowed_signers:
      - "org.electrum.electrum"

  - pattern: "~/Library/Application Support/exodus/exodus.wallet/*"
    allowed_programs:
      - Exodus
    allowed_signers:
      - "com.exodus.exodus"

  - pattern: "~/Library/Application Support/atomic/Local Storage/leveldb/*"
    allowed_programs:
      - "Atomic Wallet"
    allowed_signers:
      - "com.atomicwallet.atomicwallet"

  # Discord Token
  - pattern: "~/Library/Application Support/discord/Local Storage/leveldb/*"
    allowed_programs:
      - Discord
    allowed_signers:
      - "com.hnc.Discord"

  # Slack Cookies/Tokens
  - pattern: "~/Library/Application Support/Slack/Cookies"
    allowed_programs:
      - Slack
    allowed_signers:
      - "com.tinyspeck.slackmacgap"

  - pattern: "~/Library/Application Support/Slack/Local Storage/leveldb/*"
    allowed_programs:
      - Slack
    allowed_signers:
      - "com.tinyspeck.slackmacgap"

  # Telegram Session
  - pattern: "~/Library/Application Support/Telegram Desktop/tdata/*"
    allowed_programs:
      - "Telegram Desktop"
      - Telegram
    allowed_signers:
      - "com.tdesktop.Telegram"

  # Signal Database
  - pattern: "~/Library/Application Support/Signal/sql/db.sqlite"
    allowed_programs:
      - Signal
    allowed_signers:
      - "org.whispersystems.signal-desktop"

  - pattern: "~/Library/Application Support/Signal/config.json"
    allowed_programs:
      - Signal
    allowed_signers:
      - "org.whispersystems.signal-desktop"

  # Brave Browser
  - pattern: "~/Library/Application Support/BraveSoftware/Brave-Browser/*/Login Data"
    allowed_programs:
      - "Brave Browser"
      - brave
    allowed_signers:
      - "com.brave.Browser"

  - pattern: "~/Library/Application Support/BraveSoftware/Brave-Browser/*/Cookies"
    allowed_programs:
      - "Brave Browser"
      - brave
    allowed_signers:
      - "com.brave.Browser"

  # Edge Browser
  - pattern: "~/Library/Application Support/Microsoft Edge/*/Login Data"
    allowed_programs:
      - "Microsoft Edge"
      - msedge
    allowed_signers:
      - "com.microsoft.edgemac"

  - pattern: "~/Library/Application Support/Microsoft Edge/*/Cookies"
    allowed_programs:
      - "Microsoft Edge"
      - msedge
    allowed_signers:
      - "com.microsoft.edgemac"

  # Opera Browser
  - pattern: "~/Library/Application Support/com.operasoftware.Opera/Login Data"
    allowed_programs:
      - Opera
    allowed_signers:
      - "com.operasoftware.Opera"

  - pattern: "~/Library/Application Support/com.operasoftware.Opera/Cookies"
    allowed_programs:
      - Opera
    allowed_signers:
      - "com.operasoftware.Opera"

  # FileZilla
  - pattern: "~/.config/filezilla/recentservers.xml"
    allowed_programs:
      - filezilla
      - FileZilla

  - pattern: "~/.config/filezilla/sitemanager.xml"
    allowed_programs:
      - filezilla
      - FileZilla

  # Authy Desktop
  - pattern: "~/Library/Application Support/Authy Desktop/Local Storage/leveldb/*"
    allowed_programs:
      - "Authy Desktop"
    allowed_signers:
      - "com.authy.authy-desktop"

  # Steam
  - pattern: "~/Library/Application Support/Steam/config/loginusers.vdf"
    allowed_programs:
      - steam
      - Steam
    allowed_signers:
      - "com.valvesoftware.steam"

  # Battle.net
  - pattern: "~/Library/Application Support/Battle.net/Account/*"
    allowed_programs:
      - "Battle.net"
    allowed_signers:
      - "com.blizzard.battle.net"

  # Notion
  - pattern: "~/Library/Application Support/Notion/notion.db"
    allowed_programs:
      - Notion
    allowed_signers:
      - "notion.id"

  # TablePlus Database Credentials
  - pattern: "~/Library/Application Support/com.tinyapp.TablePlus/Data/Connections.plist"
    allowed_programs:
      - TablePlus
    allowed_signers:
      - "com.tinyapp.TablePlus"

  # Sequel Pro Database Credentials
  - pattern: "~/Library/Application Support/Sequel Pro/Data/Favorites.plist"
    allowed_programs:
      - "Sequel Pro"
    allowed_signers:
      - "com.sequelpro.SequelPro"

  # DBeaver Connections
  - pattern: "~/.dbeaver/credentials-config.json"
    allowed_programs:
      - dbeaver
      - DBeaver

  # Postman Collections/Environments
  - pattern: "~/Library/Application Support/Postman/storage/*"
    allowed_programs:
      - Postman
    allowed_signers:
      - "com.postmanlabs.mac"

  # Insomnia REST Client
  - pattern: "~/Library/Application Support/Insomnia/insomnia.*.db"
    allowed_programs:
      - Insomnia
    allowed_signers:
      - "com.insomnia.app"

  # RDP Connection Files
  - pattern: "~/Documents/*.rdp"
    allowed_programs:
      - "Microsoft Remote Desktop"
    allowed_signers:
      - "com.microsoft.rdc.macos"

  # VPN Configurations
  - pattern: "~/Library/Application Support/Viscosity/OpenVPN/*"
    allowed_programs:
      - Viscosity
    allowed_signers:
      - "com.viscosityvpn.Viscosity"

  - pattern: "~/Library/Application Support/Tunnelblick/Configurations/*"
    allowed_programs:
      - Tunnelblick
    allowed_signers:
      - "net.tunnelblick.tunnelblick"

  # Cyberduck Bookmarks
  - pattern: "~/Library/Group Containers/G69SCX94XU.duck/Library/Application Support/duck/Bookmarks/*"
    allowed_programs:
      - Cyberduck
    allowed_signers:
      - "ch.sudo.cyberduck"

  # Transmit FTP
  - pattern: "~/Library/Application Support/Transmit/Favorites/*"
    allowed_programs:
      - Transmit
    allowed_signers:
      - "com.panic.Transmit"

  # GitHub Desktop
  - pattern: "~/Library/Application Support/GitHub Desktop/storage/userData.json"
    allowed_programs:
      - "GitHub Desktop"
    allowed_signers:
      - "com.github.GitHubClient"

  # Sourcetree
  - pattern: "~/Library/Application Support/SourceTree/accounts.json"
    allowed_programs:
      - SourceTree
    allowed_signers:
      - "com.torusknot.SourceTreeNotMAS"

  # GitKraken
  - pattern: "~/.gitkraken/profiles/*"
    allowed_programs:
      - GitKraken
    allowed_signers:
      - "com.axosoft.gitkraken"

  # Environment files
  - pattern: "~/.env"
    allowed_programs:
      - code
      - vim
      - nvim
      - emacs
      - nano
    allowed_signers:
      - "com.microsoft.VSCode"

  - pattern: "~/*/.env"
    allowed_programs:
      - code
      - vim
      - nvim
      - node
      - python
      - python3
    allowed_signers:
      - "com.microsoft.VSCode"

  - pattern: "~/*/.env.local"
    allowed_programs:
      - code
      - vim
      - nvim
      - node
      - python
      - python3
    allowed_signers:
      - "com.microsoft.VSCode"

  # GitHub CLI
  - pattern: "~/.config/gh/hosts.yml"
    allowed_programs:
      - gh

  # Heroku CLI
  - pattern: "~/.netrc"
    allowed_programs:
      - heroku
      - curl
      - wget
      - git

  # Netlify CLI
  - pattern: "~/.netlify/config.json"
    allowed_programs:
      - netlify
      - ntl

  # Vercel CLI
  - pattern: "~/.vercel/auth.json"
    allowed_programs:
      - vercel
      - vc

  # Linux-specific paths
  - pattern: "~/.local/share/keyrings/*.keyring"
    allowed_programs:
      - gnome-keyring-daemon
      - seahorse
      - secret-tool

  - pattern: "~/.config/google-chrome/*/Login Data"
    allowed_programs:
      - chrome
      - google-chrome
      - google-chrome-stable

  - pattern: "~/.config/google-chrome/*/Cookies"
    allowed_programs:
      - chrome
      - google-chrome
      - google-chrome-stable

  # Chrome Beta on Linux
  - pattern: "~/.config/google-chrome-beta/*/Login Data"
    allowed_programs:
      - chrome-beta
      - google-chrome-beta

  - pattern: "~/.config/google-chrome-beta/*/Cookies"
    allowed_programs:
      - chrome-beta
      - google-chrome-beta

  - pattern: "~/.config/google-chrome-beta/*/Web Data"
    allowed_programs:
      - chrome-beta
      - google-chrome-beta

  # Chrome Dev/Canary on Linux (called 'unstable')
  - pattern: "~/.config/google-chrome-unstable/*/Login Data"
    allowed_programs:
      - chrome-unstable
      - google-chrome-unstable

  - pattern: "~/.config/google-chrome-unstable/*/Cookies"
    allowed_programs:
      - chrome-unstable
      - google-chrome-unstable

  - pattern: "~/.config/google-chrome-unstable/*/Web Data"
    allowed_programs:
      - chrome-unstable
      - google-chrome-unstable

  - pattern: "~/.mozilla/firefox/*/logins.json"
    allowed_programs:
      - firefox
      - firefox-bin

  - pattern: "~/.mozilla/firefox/*/cookies.sqlite"
    allowed_programs:
      - firefox
      - firefox-bin

  # Zen Browser on Linux
  - pattern: "~/.zen/*/profiles/*/logins.json"
    allowed_programs:
      - zen
      - zen-browser

  - pattern: "~/.zen/*/profiles/*/key*.db"
    allowed_programs:
      - zen
      - zen-browser

  - pattern: "~/.zen/*/profiles/*/cookies.sqlite"
    allowed_programs:
      - zen
      - zen-browser

  - pattern: "~/.config/zen/*/profiles/*/logins.json"
    allowed_programs:
      - zen
      - zen-browser

  - pattern: "~/.config/zen/*/profiles/*/key*.db"
    allowed_programs:
      - zen
      - zen-browser

  - pattern: "~/.config/zen/*/profiles/*/cookies.sqlite"
    allowed_programs:
      - zen
      - zen-browser

  - pattern: "~/.thunderbird/*/logins.json"
    allowed_programs:
      - thunderbird

  - pattern: "~/.config/discord/Local Storage/leveldb/*"
    allowed_programs:
      - discord
      - Discord

  - pattern: "~/.config/Slack/Cookies"
    allowed_programs:
      - slack

  - pattern: "~/.config/Code/User/globalStorage/*"
    allowed_programs:
      - code
      - code-oss

# Patterns to exclude from monitoring (reduce noise)
excluded_patterns:
  - "*.pub"           # Public keys
  - "*.public"        # Public files
  - "*/.git/*"        # Git internals
  - "*/node_modules/*" # Node modules
  - "*/__pycache__/*" # Python cache
  - "*/target/*"      # Rust/Cargo build
  - "*.log"           # Log files
  - "*.tmp"           # Temporary files

# Platform-specific allowed paths for executables
allowed_paths:
  macos:
    - /usr/bin
    - /bin
    - /usr/sbin
    - /sbin
    - /System/Library
    - /usr/local/bin
    - /usr/local/sbin
    - /opt/homebrew/bin
    - /opt/homebrew/sbin
    - /Applications/*/Contents/MacOS
    - ~/Applications/*/Contents/MacOS
    - /System/Applications/*/Contents/MacOS

  linux:
    - /usr/bin
    - /bin
    - /usr/sbin
    - /sbin
    - /usr/local/bin
    - /usr/local/sbin
    - /opt/*/bin
    - /snap/bin
    - /var/lib/flatpak/exports/bin
    - ~/.local/bin

  freebsd:
    - /usr/bin
    - /bin
    - /usr/sbin
    - /sbin
    - /usr/local/bin
    - /usr/local/sbin
    - /usr/pkg/bin        # pkgsrc binaries
    - /usr/pkg/sbin
    - /usr/ports/*/work/stage/usr/local/bin  # Ports build directories
    - ~/.local/bin
    - /usr/home/*/.cargo/bin  # Rust binaries
    - /usr/home/*/go/bin      # Go binaries

  netbsd:
    - /usr/bin
    - /bin
    - /usr/sbin
    - /sbin
    - /usr/pkg/bin        # pkgsrc is native to NetBSD
    - /usr/pkg/sbin
    - /usr/X11R7/bin      # X11 binaries
    - ~/.local/bin
    - /home/*/.cargo/bin  # Rust binaries
    - /home/*/go/bin      # Go binaries

  openbsd:
    - /usr/bin
    - /bin
    - /usr/sbin
    - /sbin
    - /usr/local/bin
    - /usr/local/sbin
    - /usr/X11R6/bin      # X11 binaries
    - ~/.local/bin
    - /home/*/.cargo/bin  # Rust binaries
    - /home/*/go/bin      # Go binaries

  illumos:
    - /usr/bin
    - /bin
    - /usr/sbin
    - /sbin
    - /opt/local/bin      # SmartOS pkgsrc
    - /opt/local/sbin
    - /usr/gnu/bin        # GNU utilities
    - /opt/ooce/bin       # OmniOS Community Edition packages
    - ~/.local/bin
    - /export/home/*/.cargo/bin  # Rust binaries
    - /export/home/*/go/bin      # Go binaries

  solaris:
    - /usr/bin
    - /bin
    - /usr/sbin
    - /sbin
    - /opt/csw/bin        # OpenCSW packages
    - /opt/csw/sbin
    - /usr/sfw/bin        # Sun Freeware
    - /usr/gnu/bin        # GNU utilities
    - ~/.local/bin
    - /export/home/*/.cargo/bin  # Rust binaries
    - /export/home/*/go/bin      # Go binaries

# Monitoring configuration
monitoring:
  # Paths to monitor (Linux fanotify)
  watch_paths:
    - /home
    - /root

  # Event buffer size
  buffer_size: 8192

  # Maximum events per second (rate limiting)
  max_events_per_sec: 10000